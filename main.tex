\documentclass[sigplan,10pt,anonymous,review,nonacm,screen]{acmart}
% \settopmatter{printfolios=true,printccs=false,printacmref=false}
\usepackage[utf8]{inputenc}
\usepackage{subcaption}
\usepackage{listings}
\usepackage{multicol}
\usepackage[cache=false]{minted}
\usepackage{listings}
%\usepackage{xcolor}
\usepackage[nounderscore]{syntax}
\usepackage{graphicx}
\usepackage{xspace}
\usepackage{stmaryrd}
\usepackage{newunicodechar}
\newunicodechar{ə}{\pmschwa}
\DeclareRobustCommand{\pmschwa}{\rotatebox[origin=c]{180}{e}}


% Minted options
\setminted{fontsize=\footnotesize}
\definecolor{coqbg}{rgb}{0.95,0.95,0.95}


% Colors
\definecolor{darkgray}{HTML}{404040}
\definecolor{rulegray}{HTML}{DADADA}
\definecolor{keywordblue}{HTML}{1F497C}
\definecolor{mygray}{gray}{0.6}
% Listings
\lstdefinestyle{code}{
  basicstyle=\scriptsize,
  %backgroundcolor=\color{rulegray},
   numbers=left,
  emph=[1]{BEGIN, END, INPUT},
  emphstyle=[1]{\color{black}},
  keywordstyle=\color{keywordblue},
  keywords={LET, IN,CASE,IF,ELSE,THEN, WITH},
  escapeinside={(*@}{@*)}
}
% Listings
%\lstdefinestyle{code}{
  %basicstyle=\scriptsize,
  %keywordstyle=\color{keywordblue},
  %keywords={import,qualified,as,do,where}
%}


\newcommand{\mynote}[3]
    {{\color{#3} \fbox{\bfseries\sffamily\scriptsize#1}
    {\small$\blacktriangleright$\textsf{\emph{#2}}$\blacktriangleleft$}}~}
\newcommand{\et}[1]{\mynote{ET}{#1}{purple}}
\newcommand{\fo}[1]{\mynote{FO}{#1}{brown}}
\newcommand{\td}[1]{\mynote{TD}{#1}{blue}}

\newcommand\mdoubleplus{\mathbin{+\mkern-5mu+}}

% naming
\newcommand{\plstyle}[1]{\mbox{\textsc{#1}}\xspace}
\newcommand{\gql}{\plstyle{GraphQL}}
\newcommand{\gcoql}{\plstyle{GraphCoQL}}
\newcommand{\spec}{\plstyle{Spec}}
\newcommand{\HP}{\plstyle{H\&P}}
\newcommand{\json}{\plstyle{JSON}}
\newcommand{\jscert}{\plstyle{JSCert}}
\newcommand{\coqr}{\plstyle{CoqR}}
\newcommand{\coq}{\plstyle{Coq}}
\newcommand{\ssreflect}{\plstyle{Ssreflect}}
\newcommand{\mathcomp}{\plstyle{Mathematical Components}}
\newcommand{\equations}{\plstyle{Equations}}
\newcommand{\Vals}{$\mathit{Value}$\xspace}
\newcommand{\goodbois}{\plstyle{GoodBois}}

% math naming 
\newcommand{\query}{\varphi}
\newcommand{\sset}{\overline{\sigma}}
\newcommand{\sel}{\sigma}
\newcommand{\schema}{\mathcal{S}\xspace}
\newcommand{\graph}{\mathcal{G}\xspace}

\newcommand{\response}{\rho}
\newcommand{\ssize}[1]{\lvert #1 \rvert}

\newcommand{\name}{\mathit{name}}

% semantics
\newcommand{\filter}[2]{\mathit{filter}_{#2}(#1)}

\newcommand{\eval}[2]{\llbracket #1 \rrbracket^{#2}_{G}}
\newcommand{\evalu}[1]{\eval{#1}{u}}
\newcommand{\evalfilteru}[2]{\eval{\mathit{filter}_{#2}(#1)}{u}}
% simpl semantics
\newcommand{\seval}[2]{\llparenthesis #1 \rrparenthesis^{#2}_{G}}
\newcommand{\sevalu}[1]{\seval{#1}{u}}

\newcommand{\queries}{\overline{\varphi}}
\newcommand{\subqueries}[1]{\overline{#1}}
\newcommand{\fkey}{\texttt{f}}

%selections
\newcommand{\args}{\overline{\alpha}}
\newcommand{\fld}{\texttt{f[}\args\texttt{]}}
\newcommand{\afld}{\texttt{a:}\fld}

\newcommand{\nfld}[1]{\fld\; \texttt{\{}#1\texttt{\}} }
\newcommand{\anfld}[1]{\afld\; \texttt{\{}#1\texttt{\}} }

\newcommand{\ifrag}[2]{\texttt{... on #1 \{}#2\texttt{\}}}
\newcommand{\resp}[1]{\fkey\texttt{:}#1}
\newcommand{\nval}{\texttt{null}}
\newcommand{\val}{\texttt{v}}

%normalize
%\newcommand{\normalize}[1]{\mathit{normalize (#1)}}
\newcommand{\norm}[2]{\mathcal{N}_{\mathit{#1}}(#2)}
\newcommand{\tnorm}[1]{\norm{ts}{#1}}

%misc
\newcommand{\ie}{i.e.\@\xspace}
\newcommand{\wrt}{w.r.t.\@\xspace}
\newcommand{\eg}{e.g.\@\xspace}
\newcommand{\cf}{cf.\@\xspace}
\newcommand{\viz}{viz.\@\xspace}
\newcommand{\etal}{et al.\@\xspace}
\newcommand{\vscalar}{check\_scalar}

\begin{document}

\title{A Mechanized Formalization of \gql}
\author{Tomás Díaz}
\affiliation{%
  \institution{IMFD Chile}
  \city{Santiago}
  \country{Chile}
}

\author{Federico Olmedo}
\affiliation{%<
  \institution{University of Chile \& IMFD Chile}
  \department{Computer Science Department (DCC)}
  \city{Santiago}
  \country{Chile}
}
\author{Éric Tanter}
\affiliation{%
  \institution{University of Chile \& IMFD Chile}
  \department{Computer Science Department (DCC)}
  \city{Santiago}
  \country{Chile}
}

\begin{abstract}
\gql is a novel language for specifying and querying web APIs,
allowing clients to flexibility and efficiently retrieve data of
interest. The \gql language specification is unfortunately only
available in prose, making it hard to develop robust formal results
for this language. Recently, Hartig and Pérez proposed a formal
semantics for \gql in order to study the complexity of \gql
queries. These semantics\fo{``introduced \emph{a} semantics [\ldots] \emph{These}
  semantics \emph{are}'' mismatch} are however not mechanized and leave certain key aspects unverified. We present \gcoql, the first mechanized formalization of \gql, developed in the \coq proof assistant.  \gcoql covers the schema definition DSL, query definitions, validation of both schema and queries, as well as the semantics of queries over a graph data model.
We illustrate the application of \gcoql by formalizing the key query transformation and interpretation techniques of Hartig and Pérez, and proving them correct, after addressing some imprecisions and minor issues. 
We hope that \gcoql can serve as a solid formal baseline for both language design and verification efforts for \gql.
\end{abstract}


\maketitle


\input{introduction.tex}
\input{background.tex}
\input{formalization.tex}
\input{normalization.tex}
\input{discussion.tex}
% \input{limitations.tex}
% \input{validation.tex}
\input{related.tex}
\input{conclusions.tex}

\clearpage
\bibliographystyle{acm}
\bibliography{biblio}
\end{document}
